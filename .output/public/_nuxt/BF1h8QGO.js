import{c as x,b as J,au as xe,K as j,av as oe,aw as Se,D as $,M as re,d as W,E as Oe,a9 as _,aa as ue,L as le,ab as Y,F as Ie,O as G,ad as de,ax as Re,ac as B}from"./C1Qq1QLd.js";import{o as te}from"./DnFU_lOv.js";import{u as N,o as I,t as ye,i as Q,E as Ce,A as H,T as ne,I as Z,N as X,l as we}from"./jXwMPzuP.js";import{w as Ee,f as Te,u as Me,i as ze,O as Pe,n as De}from"./DQ9UKlTQ.js";import{s as Ae,o as V}from"./BV9iaqG7.js";import{c as D,f as ie,i as $e,t as ae,u as Fe}from"./Ba5XwZFk.js";function q(l,s,t){let o=t.initialDeps??[],e;return()=>{var a,i,n,f;let h;t.key&&((a=t.debug)!=null&&a.call(t))&&(h=Date.now());const p=l();if(!(p.length!==o.length||p.some((M,R)=>o[R]!==M)))return e;o=p;let C;if(t.key&&((i=t.debug)!=null&&i.call(t))&&(C=Date.now()),e=s(...p),t.key&&((n=t.debug)!=null&&n.call(t))){const M=Math.round((Date.now()-h)*100)/100,R=Math.round((Date.now()-C)*100)/100,A=R/16,F=(P,m)=>{for(P=String(P);P.length<m;)P=" "+P;return P};console.info(`%c⏱ ${F(R,5)} /${F(M,5)} ms`,`
            font-size: .6rem;
            font-weight: bold;
            color: hsl(${Math.max(0,Math.min(120-120*A,120))}deg 100% 31%);`,t==null?void 0:t.key)}return(f=t==null?void 0:t.onChange)==null||f.call(t,e),e}}function ee(l,s){if(l===void 0)throw new Error("Unexpected undefined");return l}const Ve=(l,s)=>Math.abs(l-s)<1,ke=(l,s,t)=>{let o;return function(...e){l.clearTimeout(o),o=l.setTimeout(()=>s.apply(this,e),t)}},_e=l=>l,Be=l=>{const s=Math.max(l.startIndex-l.overscan,0),t=Math.min(l.endIndex+l.overscan,l.count-1),o=[];for(let e=s;e<=t;e++)o.push(e);return o},je=(l,s)=>{const t=l.scrollElement;if(!t)return;const o=l.targetWindow;if(!o)return;const e=i=>{const{width:n,height:f}=i;s({width:Math.round(n),height:Math.round(f)})};if(e(t.getBoundingClientRect()),!o.ResizeObserver)return()=>{};const a=new o.ResizeObserver(i=>{const n=i[0];if(n!=null&&n.borderBoxSize){const f=n.borderBoxSize[0];if(f){e({width:f.inlineSize,height:f.blockSize});return}}e(t.getBoundingClientRect())});return a.observe(t,{box:"border-box"}),()=>{a.unobserve(t)}},se={passive:!0},Le=typeof window>"u"?!0:"onscrollend"in window,Ne=(l,s)=>{const t=l.scrollElement;if(!t)return;const o=l.targetWindow;if(!o)return;let e=0;const a=Le?()=>{}:ke(o,()=>{s(e,!1)},l.options.isScrollingResetDelay),i=h=>()=>{e=t[l.options.horizontal?"scrollLeft":"scrollTop"],a(),s(e,h)},n=i(!0),f=i(!1);return f(),t.addEventListener("scroll",n,se),t.addEventListener("scrollend",f,se),()=>{t.removeEventListener("scroll",n),t.removeEventListener("scrollend",f)}},We=(l,s,t)=>{if(s!=null&&s.borderBoxSize){const o=s.borderBoxSize[0];if(o)return Math.round(o[t.options.horizontal?"inlineSize":"blockSize"])}return Math.round(l.getBoundingClientRect()[t.options.horizontal?"width":"height"])},Ke=(l,{adjustments:s=0,behavior:t},o)=>{var e,a;const i=l+s;(a=(e=o.scrollElement)==null?void 0:e.scrollTo)==null||a.call(e,{[o.options.horizontal?"left":"top"]:i,behavior:t})};class Ue{constructor(s){this.unsubs=[],this.scrollElement=null,this.targetWindow=null,this.isScrolling=!1,this.scrollToIndexTimeoutId=null,this.measurementsCache=[],this.itemSizeCache=new Map,this.pendingMeasuredCacheIndexes=[],this.scrollRect=null,this.scrollOffset=null,this.scrollDirection=null,this.scrollAdjustments=0,this.elementsCache=new Map,this.observer=(()=>{let t=null;const o=()=>t||(!this.targetWindow||!this.targetWindow.ResizeObserver?null:t=new this.targetWindow.ResizeObserver(e=>{e.forEach(a=>{this._measureElement(a.target,a)})}));return{disconnect:()=>{var e;return(e=o())==null?void 0:e.disconnect()},observe:e=>{var a;return(a=o())==null?void 0:a.observe(e,{box:"border-box"})},unobserve:e=>{var a;return(a=o())==null?void 0:a.unobserve(e)}}})(),this.range=null,this.setOptions=t=>{Object.entries(t).forEach(([o,e])=>{typeof e>"u"&&delete t[o]}),this.options={debug:!1,initialOffset:0,overscan:1,paddingStart:0,paddingEnd:0,scrollPaddingStart:0,scrollPaddingEnd:0,horizontal:!1,getItemKey:_e,rangeExtractor:Be,onChange:()=>{},measureElement:We,initialRect:{width:0,height:0},scrollMargin:0,gap:0,indexAttribute:"data-index",initialMeasurementsCache:[],lanes:1,isScrollingResetDelay:150,enabled:!0,...t}},this.notify=(t,o)=>{var e,a;const{startIndex:i,endIndex:n}=this.range??{startIndex:void 0,endIndex:void 0},f=this.calculateRange();(t||i!==(f==null?void 0:f.startIndex)||n!==(f==null?void 0:f.endIndex))&&((a=(e=this.options).onChange)==null||a.call(e,this,o))},this.cleanup=()=>{this.unsubs.filter(Boolean).forEach(t=>t()),this.unsubs=[],this.scrollElement=null,this.targetWindow=null,this.observer.disconnect(),this.elementsCache.clear()},this._didMount=()=>()=>{this.cleanup()},this._willUpdate=()=>{var t;const o=this.options.enabled?this.options.getScrollElement():null;if(this.scrollElement!==o){if(this.cleanup(),!o){this.notify(!1,!1);return}this.scrollElement=o,this.scrollElement&&"ownerDocument"in this.scrollElement?this.targetWindow=this.scrollElement.ownerDocument.defaultView:this.targetWindow=((t=this.scrollElement)==null?void 0:t.window)??null,this._scrollToOffset(this.getScrollOffset(),{adjustments:void 0,behavior:void 0}),this.unsubs.push(this.options.observeElementRect(this,e=>{this.scrollRect=e,this.notify(!1,!1)})),this.unsubs.push(this.options.observeElementOffset(this,(e,a)=>{this.scrollAdjustments=0,this.scrollDirection=a?this.getScrollOffset()<e?"forward":"backward":null,this.scrollOffset=e;const i=this.isScrolling;this.isScrolling=a,this.notify(i!==a,a)}))}},this.getSize=()=>this.options.enabled?(this.scrollRect=this.scrollRect??this.options.initialRect,this.scrollRect[this.options.horizontal?"width":"height"]):(this.scrollRect=null,0),this.getScrollOffset=()=>this.options.enabled?(this.scrollOffset=this.scrollOffset??(typeof this.options.initialOffset=="function"?this.options.initialOffset():this.options.initialOffset),this.scrollOffset):(this.scrollOffset=null,0),this.getFurthestMeasurement=(t,o)=>{const e=new Map,a=new Map;for(let i=o-1;i>=0;i--){const n=t[i];if(e.has(n.lane))continue;const f=a.get(n.lane);if(f==null||n.end>f.end?a.set(n.lane,n):n.end<f.end&&e.set(n.lane,!0),e.size===this.options.lanes)break}return a.size===this.options.lanes?Array.from(a.values()).sort((i,n)=>i.end===n.end?i.index-n.index:i.end-n.end)[0]:void 0},this.getMeasurementOptions=q(()=>[this.options.count,this.options.paddingStart,this.options.scrollMargin,this.options.getItemKey,this.options.enabled],(t,o,e,a,i)=>(this.pendingMeasuredCacheIndexes=[],{count:t,paddingStart:o,scrollMargin:e,getItemKey:a,enabled:i}),{key:!1}),this.getMeasurements=q(()=>[this.getMeasurementOptions(),this.itemSizeCache],({count:t,paddingStart:o,scrollMargin:e,getItemKey:a,enabled:i},n)=>{var f;if(!i)return this.measurementsCache=[],this.itemSizeCache.clear(),[];this.measurementsCache.length===0&&(this.measurementsCache=this.options.initialMeasurementsCache,this.measurementsCache.forEach(d=>{this.itemSizeCache.set(d.key,d.size)}));const h=this.pendingMeasuredCacheIndexes.length>0?Math.min(...this.pendingMeasuredCacheIndexes):0;this.pendingMeasuredCacheIndexes=[];const p=this.measurementsCache.slice(0,h);for(let d=h;d<t;d++){let C=(f=this.measurementsCache[d])==null?void 0:f.measureElement;C||(C=z=>{const c=a(d),S=this.elementsCache.get(c);if(!z){S&&(this.observer.unobserve(S),this.elementsCache.delete(c));return}S!==z&&(S&&this.observer.unobserve(S),this.observer.observe(z),this.elementsCache.set(c,z)),z.isConnected&&this.resizeItem(d,this.options.measureElement(z,void 0,this))});const M=a(d),R=this.options.lanes===1?p[d-1]:this.getFurthestMeasurement(p,d),A=R?R.end+this.options.gap:o+e,F=n.get(M),P=typeof F=="number"?F:this.options.estimateSize(d),m=A+P,y=R?R.lane:d%this.options.lanes;p[d]={index:d,start:A,size:P,end:m,key:M,lane:y,measureElement:C}}return this.measurementsCache=p,p},{key:!1,debug:()=>this.options.debug}),this.calculateRange=q(()=>[this.getMeasurements(),this.getSize(),this.getScrollOffset()],(t,o,e)=>this.range=t.length>0&&o>0?qe({measurements:t,outerSize:o,scrollOffset:e}):null,{key:!1,debug:()=>this.options.debug}),this.getIndexes=q(()=>[this.options.rangeExtractor,this.calculateRange(),this.options.overscan,this.options.count],(t,o,e,a)=>o===null?[]:t({startIndex:o.startIndex,endIndex:o.endIndex,overscan:e,count:a}),{key:!1,debug:()=>this.options.debug}),this.indexFromElement=t=>{const o=this.options.indexAttribute,e=t.getAttribute(o);return e?parseInt(e,10):(console.warn(`Missing attribute name '${o}={index}' on measured element.`),-1)},this._measureElement=(t,o)=>{const e=this.indexFromElement(t),a=this.getMeasurements()[e];if(!a||!t.isConnected){this.elementsCache.forEach((n,f)=>{n===t&&(this.observer.unobserve(t),this.elementsCache.delete(f))});return}const i=this.elementsCache.get(a.key);i!==t&&(i&&this.observer.unobserve(i),this.observer.observe(t),this.elementsCache.set(a.key,t)),this.resizeItem(e,this.options.measureElement(t,o,this))},this.resizeItem=(t,o)=>{const e=this.getMeasurements()[t];if(!e)return;const a=this.itemSizeCache.get(e.key)??e.size,i=o-a;i!==0&&((this.shouldAdjustScrollPositionOnItemSizeChange!==void 0?this.shouldAdjustScrollPositionOnItemSizeChange(e,i,this):e.start<this.getScrollOffset()+this.scrollAdjustments)&&this._scrollToOffset(this.getScrollOffset(),{adjustments:this.scrollAdjustments+=i,behavior:void 0}),this.pendingMeasuredCacheIndexes.push(e.index),this.itemSizeCache=new Map(this.itemSizeCache.set(e.key,o)),this.notify(!0,!1))},this.measureElement=t=>{t&&this._measureElement(t,void 0)},this.getVirtualItems=q(()=>[this.getIndexes(),this.getMeasurements()],(t,o)=>{const e=[];for(let a=0,i=t.length;a<i;a++){const n=t[a],f=o[n];e.push(f)}return e},{key:!1,debug:()=>this.options.debug}),this.getVirtualItemForOffset=t=>{const o=this.getMeasurements();if(o.length!==0)return ee(o[ce(0,o.length-1,e=>ee(o[e]).start,t)])},this.getOffsetForAlignment=(t,o)=>{const e=this.getSize(),a=this.getScrollOffset();o==="auto"&&(t<=a?o="start":t>=a+e?o="end":o="start"),o==="start"?t=t:o==="end"?t=t-e:o==="center"&&(t=t-e/2);const i=this.options.horizontal?"scrollWidth":"scrollHeight",f=(this.scrollElement?"document"in this.scrollElement?this.scrollElement.document.documentElement[i]:this.scrollElement[i]:0)-e;return Math.max(Math.min(f,t),0)},this.getOffsetForIndex=(t,o="auto")=>{t=Math.max(0,Math.min(t,this.options.count-1));const e=this.getMeasurements()[t];if(!e)return;const a=this.getSize(),i=this.getScrollOffset();if(o==="auto")if(e.end>=i+a-this.options.scrollPaddingEnd)o="end";else if(e.start<=i+this.options.scrollPaddingStart)o="start";else return[i,o];const n=o==="end"?e.end+this.options.scrollPaddingEnd:e.start-this.options.scrollPaddingStart;return[this.getOffsetForAlignment(n,o),o]},this.isDynamicMode=()=>this.elementsCache.size>0,this.cancelScrollToIndex=()=>{this.scrollToIndexTimeoutId!==null&&this.targetWindow&&(this.targetWindow.clearTimeout(this.scrollToIndexTimeoutId),this.scrollToIndexTimeoutId=null)},this.scrollToOffset=(t,{align:o="start",behavior:e}={})=>{this.cancelScrollToIndex(),e==="smooth"&&this.isDynamicMode()&&console.warn("The `smooth` scroll behavior is not fully supported with dynamic size."),this._scrollToOffset(this.getOffsetForAlignment(t,o),{adjustments:void 0,behavior:e})},this.scrollToIndex=(t,{align:o="auto",behavior:e}={})=>{t=Math.max(0,Math.min(t,this.options.count-1)),this.cancelScrollToIndex(),e==="smooth"&&this.isDynamicMode()&&console.warn("The `smooth` scroll behavior is not fully supported with dynamic size.");const a=this.getOffsetForIndex(t,o);if(!a)return;const[i,n]=a;this._scrollToOffset(i,{adjustments:void 0,behavior:e}),e!=="smooth"&&this.isDynamicMode()&&this.targetWindow&&(this.scrollToIndexTimeoutId=this.targetWindow.setTimeout(()=>{if(this.scrollToIndexTimeoutId=null,this.elementsCache.has(this.options.getItemKey(t))){const[h]=ee(this.getOffsetForIndex(t,n));Ve(h,this.getScrollOffset())||this.scrollToIndex(t,{align:n,behavior:e})}else this.scrollToIndex(t,{align:n,behavior:e})}))},this.scrollBy=(t,{behavior:o}={})=>{this.cancelScrollToIndex(),o==="smooth"&&this.isDynamicMode()&&console.warn("The `smooth` scroll behavior is not fully supported with dynamic size."),this._scrollToOffset(this.getScrollOffset()+t,{adjustments:void 0,behavior:o})},this.getTotalSize=()=>{var t;const o=this.getMeasurements();let e;return o.length===0?e=this.options.paddingStart:e=this.options.lanes===1?((t=o[o.length-1])==null?void 0:t.end)??0:Math.max(...o.slice(-this.options.lanes).map(a=>a.end)),e-this.options.scrollMargin+this.options.paddingEnd},this._scrollToOffset=(t,{adjustments:o,behavior:e})=>{this.options.scrollToFn(t,{behavior:e,adjustments:o},this)},this.measure=()=>{var t,o;this.itemSizeCache=new Map,(o=(t=this.options).onChange)==null||o.call(t,this,!1)},this.setOptions(s)}}const ce=(l,s,t,o)=>{for(;l<=s;){const e=(l+s)/2|0,a=t(e);if(a<o)l=e+1;else if(a>o)s=e-1;else return e}return l>0?l-1:0};function qe({measurements:l,outerSize:s,scrollOffset:t}){const o=l.length-1,a=ce(0,o,n=>l[n].start,t);let i=a;for(;i<o&&l[i].end<t+s;)i++;return{startIndex:a,endIndex:i}}function He(l){const s=new Ue(J(l)),t=xe(s),o=s._didMount();return j(()=>J(l).getScrollElement(),e=>{e&&s._willUpdate()},{immediate:!0}),j(()=>J(l),e=>{s.setOptions({...e,onChange:(a,i)=>{var n;oe(t),(n=e.onChange)==null||n.call(e,a,i)}}),s._willUpdate(),oe(t)},{immediate:!0}),Se(o),t}function Je(l){return He(x(()=>({observeElementRect:je,observeElementOffset:Ne,scrollToFn:Ke,...J(l)})))}function Ye(l,s,t){let o=$(t==null?void 0:t.value),e=x(()=>l.value!==void 0);return[x(()=>e.value?l.value:o.value),function(a){return e.value||(o.value=a),s==null?void 0:s(a)}]}function Ge(){let l=te();return re(()=>l.dispose()),l}function Qe(){let l=Ge();return s=>{l.dispose(),l.nextFrame(s)}}var ve=(l=>(l[l.Left=0]="Left",l[l.Right=2]="Right",l))(ve||{});function fe(l={},s=null,t=[]){for(let[o,e]of Object.entries(l))he(t,pe(s,o),e);return t}function pe(l,s){return l?l+"["+s+"]":s}function he(l,s,t){if(Array.isArray(t))for(let[o,e]of t.entries())he(l,pe(s,o.toString()),e);else t instanceof Date?l.push([s,t.toISOString()]):typeof t=="boolean"?l.push([s,t?"1":"0"]):typeof t=="string"?l.push([s,t]):typeof t=="number"?l.push([s,`${t}`]):t==null?l.push([s,""]):fe(t,s,l)}var Xe={};function Ze(l,s){return l===s}var et=(l=>(l[l.Open=0]="Open",l[l.Closed=1]="Closed",l))(et||{}),tt=(l=>(l[l.Single=0]="Single",l[l.Multi=1]="Multi",l))(tt||{}),lt=(l=>(l[l.Pointer=0]="Pointer",l[l.Focus=1]="Focus",l[l.Other=2]="Other",l))(lt||{});let me=Symbol("ComboboxContext");function K(l){let s=de(me,null);if(s===null){let t=new Error(`<${l} /> is missing a parent <Combobox /> component.`);throw Error.captureStackTrace&&Error.captureStackTrace(t,K),t}return s}let be=Symbol("VirtualContext"),nt=W({name:"VirtualProvider",setup(l,{slots:s}){let t=K("VirtualProvider"),o=x(()=>{let n=I(t.optionsRef);if(!n)return{start:0,end:0};let f=window.getComputedStyle(n);return{start:parseFloat(f.paddingBlockStart||f.paddingTop),end:parseFloat(f.paddingBlockEnd||f.paddingBottom)}}),e=Je(x(()=>({scrollPaddingStart:o.value.start,scrollPaddingEnd:o.value.end,count:t.virtual.value.options.length,estimateSize(){return 40},getScrollElement(){return I(t.optionsRef)},overscan:12}))),a=x(()=>{var n;return(n=t.virtual.value)==null?void 0:n.options}),i=$(0);return j([a],()=>{i.value+=1}),ue(be,t.virtual.value?e:null),()=>[Y("div",{style:{position:"relative",width:"100%",height:`${e.value.getTotalSize()}px`},ref:n=>{if(n){if(typeof process<"u"&&Xe.JEST_WORKER_ID!==void 0||t.activationTrigger.value===0)return;t.activeOptionIndex.value!==null&&t.virtual.value.options.length>t.activeOptionIndex.value&&e.value.scrollToIndex(t.activeOptionIndex.value)}}},e.value.getVirtualItems().map(n=>Re(s.default({option:t.virtual.value.options[n.index],open:t.comboboxState.value===0})[0],{key:`${i.value}-${n.index}`,"data-index":n.index,"aria-setsize":t.virtual.value.options.length,"aria-posinset":n.index+1,style:{position:"absolute",top:0,left:0,transform:`translateY(${n.start}px)`,overflowAnchor:"none"}})))]}}),dt=W({name:"Combobox",emits:{"update:modelValue":l=>!0},props:{as:{type:[Object,String],default:"template"},disabled:{type:[Boolean],default:!1},by:{type:[String,Function],nullable:!0,default:null},modelValue:{type:[Object,String,Number,Boolean],default:void 0},defaultValue:{type:[Object,String,Number,Boolean],default:void 0},form:{type:String,optional:!0},name:{type:String,optional:!0},nullable:{type:Boolean,default:!1},multiple:{type:[Boolean],default:!1},immediate:{type:[Boolean],default:!1},virtual:{type:Object,default:null}},inheritAttrs:!1,setup(l,{slots:s,attrs:t,emit:o}){let e=$(1),a=$(null),i=$(null),n=$(null),f=$(null),h=$({static:!1,hold:!1}),p=$([]),d=$(null),C=$(2),M=$(!1);function R(r=v=>v){let v=d.value!==null?p.value[d.value]:null,b=r(p.value.slice()),g=b.length>0&&b[0].dataRef.order.value!==null?b.sort((T,k)=>T.dataRef.order.value-k.dataRef.order.value):Pe(b,T=>I(T.dataRef.domRef)),E=v?g.indexOf(v):null;return E===-1&&(E=null),{options:g,activeOptionIndex:E}}let A=x(()=>l.multiple?1:0),F=x(()=>l.nullable),[P,m]=Ye(x(()=>l.modelValue),r=>o("update:modelValue",r),x(()=>l.defaultValue)),y=x(()=>P.value===void 0?N(A.value,{1:[],0:void 0}):P.value),z=null,c=null;function S(r){return N(A.value,{0(){return m==null?void 0:m(r)},1:()=>{let v=_(u.value.value).slice(),b=_(r),g=v.findIndex(E=>u.compare(b,_(E)));return g===-1?v.push(b):v.splice(g,1),m==null?void 0:m(v)}})}let w=x(()=>{});j([w],([r],[v])=>{if(u.virtual.value&&r&&v&&d.value!==null){let b=r.indexOf(v[d.value]);b!==-1?d.value=b:d.value=null}});let u={comboboxState:e,value:y,mode:A,compare(r,v){if(typeof l.by=="string"){let b=l.by;return(r==null?void 0:r[b])===(v==null?void 0:v[b])}return l.by===null?Ze(r,v):l.by(r,v)},calculateIndex(r){return u.virtual.value?l.by===null?u.virtual.value.options.indexOf(r):u.virtual.value.options.findIndex(v=>u.compare(v,r)):p.value.findIndex(v=>u.compare(v.dataRef.value,r))},defaultValue:x(()=>l.defaultValue),nullable:F,immediate:x(()=>!1),virtual:x(()=>null),inputRef:i,labelRef:a,buttonRef:n,optionsRef:f,disabled:x(()=>l.disabled),options:p,change(r){m(r)},activeOptionIndex:x(()=>{if(M.value&&d.value===null&&(u.virtual.value?u.virtual.value.options.length>0:p.value.length>0)){if(u.virtual.value){let v=u.virtual.value.options.findIndex(b=>{var g;return!((g=u.virtual.value)!=null&&g.disabled(b))});if(v!==-1)return v}let r=p.value.findIndex(v=>!v.dataRef.disabled);if(r!==-1)return r}return d.value}),activationTrigger:C,optionsPropsRef:h,closeCombobox(){M.value=!1,!l.disabled&&e.value!==1&&(e.value=1,d.value=null)},openCombobox(){if(M.value=!0,!l.disabled&&e.value!==0){if(u.value.value){let r=u.calculateIndex(u.value.value);r!==-1&&(d.value=r)}e.value=0}},setActivationTrigger(r){C.value=r},goToOption(r,v,b){M.value=!1,z!==null&&cancelAnimationFrame(z),z=requestAnimationFrame(()=>{if(l.disabled||f.value&&!h.value.static&&e.value===1)return;if(u.virtual.value){d.value=r===D.Specific?v:ie({focus:r},{resolveItems:()=>u.virtual.value.options,resolveActiveIndex:()=>{var T,k;return(k=(T=u.activeOptionIndex.value)!=null?T:u.virtual.value.options.findIndex(L=>{var U;return!((U=u.virtual.value)!=null&&U.disabled(L))}))!=null?k:null},resolveDisabled:T=>u.virtual.value.disabled(T),resolveId(){throw new Error("Function not implemented.")}}),C.value=b??2;return}let g=R();if(g.activeOptionIndex===null){let T=g.options.findIndex(k=>!k.dataRef.disabled);T!==-1&&(g.activeOptionIndex=T)}let E=r===D.Specific?v:ie({focus:r},{resolveItems:()=>g.options,resolveActiveIndex:()=>g.activeOptionIndex,resolveId:T=>T.id,resolveDisabled:T=>T.dataRef.disabled});d.value=E,C.value=b??2,p.value=g.options})},selectOption(r){let v=p.value.find(g=>g.id===r);if(!v)return;let{dataRef:b}=v;S(b.value)},selectActiveOption(){if(u.activeOptionIndex.value!==null){if(u.virtual.value)S(u.virtual.value.options[u.activeOptionIndex.value]);else{let{dataRef:r}=p.value[u.activeOptionIndex.value];S(r.value)}u.goToOption(D.Specific,u.activeOptionIndex.value)}},registerOption(r,v){let b=Oe({id:r,dataRef:v});if(u.virtual.value){p.value.push(b);return}c&&cancelAnimationFrame(c);let g=R(E=>(E.push(b),E));d.value===null&&u.isSelected(v.value.value)&&(g.activeOptionIndex=g.options.indexOf(b)),p.value=g.options,d.value=g.activeOptionIndex,C.value=2,g.options.some(E=>!I(E.dataRef.domRef))&&(c=requestAnimationFrame(()=>{let E=R();p.value=E.options,d.value=E.activeOptionIndex}))},unregisterOption(r,v){if(z!==null&&cancelAnimationFrame(z),v&&(M.value=!0),u.virtual.value){p.value=p.value.filter(g=>g.id!==r);return}let b=R(g=>{let E=g.findIndex(T=>T.id===r);return E!==-1&&g.splice(E,1),g});p.value=b.options,d.value=b.activeOptionIndex,C.value=2},isSelected(r){return N(A.value,{0:()=>u.compare(_(u.value.value),_(r)),1:()=>_(u.value.value).some(v=>u.compare(_(v),_(r)))})},isActive(r){return d.value===u.calculateIndex(r)}};Ee([i,n,f],()=>u.closeCombobox(),x(()=>e.value===0)),ue(me,u),ye(x(()=>N(e.value,{0:Q.Open,1:Q.Closed})));let O=x(()=>{var r;return(r=I(i))==null?void 0:r.closest("form")});return le(()=>{j([O],()=>{if(!O.value||l.defaultValue===void 0)return;function r(){u.change(l.defaultValue)}return O.value.addEventListener("reset",r),()=>{var v;(v=O.value)==null||v.removeEventListener("reset",r)}},{immediate:!0})}),()=>{var r,v,b;let{name:g,disabled:E,form:T,...k}=l,L={open:e.value===0,disabled:E,activeIndex:u.activeOptionIndex.value,activeOption:u.activeOptionIndex.value===null?null:u.virtual.value?u.virtual.value.options[(r=u.activeOptionIndex.value)!=null?r:0]:(b=(v=u.options.value[u.activeOptionIndex.value])==null?void 0:v.dataRef.value)!=null?b:null,value:y.value};return Y(Ie,[...g!=null&&y.value!=null?fe({[g]:y.value}).map(([U,ge])=>Y(Te,Ce({features:Me.Hidden,key:U,as:"input",type:"hidden",hidden:!0,readOnly:!0,form:T,disabled:E,name:U,value:ge}))):[],H({theirProps:{...t,...ne(k,["by","defaultValue","immediate","modelValue","multiple","nullable","onUpdate:modelValue","virtual"])},ourProps:{},slot:L,slots:s,attrs:t,name:"Combobox"})])}}}),ct=W({name:"ComboboxButton",props:{as:{type:[Object,String],default:"button"},id:{type:String,default:null}},setup(l,{attrs:s,slots:t,expose:o}){var e;let a=(e=l.id)!=null?e:`headlessui-combobox-button-${Z()}`,i=K("ComboboxButton");o({el:i.buttonRef,$el:i.buttonRef});function n(p){i.disabled.value||(i.comboboxState.value===0?i.closeCombobox():(p.preventDefault(),i.openCombobox()),B(()=>{var d;return(d=I(i.inputRef))==null?void 0:d.focus({preventScroll:!0})}))}function f(p){switch(p.key){case V.ArrowDown:p.preventDefault(),p.stopPropagation(),i.comboboxState.value===1&&i.openCombobox(),B(()=>{var d;return(d=i.inputRef.value)==null?void 0:d.focus({preventScroll:!0})});return;case V.ArrowUp:p.preventDefault(),p.stopPropagation(),i.comboboxState.value===1&&(i.openCombobox(),B(()=>{i.value.value||i.goToOption(D.Last)})),B(()=>{var d;return(d=i.inputRef.value)==null?void 0:d.focus({preventScroll:!0})});return;case V.Escape:if(i.comboboxState.value!==0)return;p.preventDefault(),i.optionsRef.value&&!i.optionsPropsRef.value.static&&p.stopPropagation(),i.closeCombobox(),B(()=>{var d;return(d=i.inputRef.value)==null?void 0:d.focus({preventScroll:!0})});return}}let h=Ae(x(()=>({as:l.as,type:s.type})),i.buttonRef);return()=>{var p,d;let C={open:i.comboboxState.value===0,disabled:i.disabled.value,value:i.value.value},{...M}=l,R={ref:i.buttonRef,id:a,type:h.value,tabindex:"-1","aria-haspopup":"listbox","aria-controls":(p=I(i.optionsRef))==null?void 0:p.id,"aria-expanded":i.comboboxState.value===0,"aria-labelledby":i.labelRef.value?[(d=I(i.labelRef))==null?void 0:d.id,a].join(" "):void 0,disabled:i.disabled.value===!0?!0:void 0,onKeydown:f,onClick:n};return H({ourProps:R,theirProps:M,slot:C,attrs:s,slots:t,name:"ComboboxButton"})}}}),vt=W({name:"ComboboxInput",props:{as:{type:[Object,String],default:"input"},static:{type:Boolean,default:!1},unmount:{type:Boolean,default:!0},displayValue:{type:Function},defaultValue:{type:String,default:void 0},id:{type:String,default:null}},emits:{change:l=>!0},setup(l,{emit:s,attrs:t,slots:o,expose:e}){var a;let i=(a=l.id)!=null?a:`headlessui-combobox-input-${Z()}`,n=K("ComboboxInput"),f=x(()=>ze(I(n.inputRef))),h={value:!1};e({el:n.inputRef,$el:n.inputRef});function p(){n.change(null);let c=I(n.optionsRef);c&&(c.scrollTop=0),n.goToOption(D.Nothing)}let d=x(()=>{var c;let S=n.value.value;return I(n.inputRef)?typeof l.displayValue<"u"&&S!==void 0?(c=l.displayValue(S))!=null?c:"":typeof S=="string"?S:"":""});le(()=>{j([d,n.comboboxState,f],([c,S],[w,u])=>{if(h.value)return;let O=I(n.inputRef);O&&((u===0&&S===1||c!==w)&&(O.value=c),requestAnimationFrame(()=>{var r;if(h.value||!O||((r=f.value)==null?void 0:r.activeElement)!==O)return;let{selectionStart:v,selectionEnd:b}=O;Math.abs((b??0)-(v??0))===0&&v===0&&O.setSelectionRange(O.value.length,O.value.length)}))},{immediate:!0}),j([n.comboboxState],([c],[S])=>{if(c===0&&S===1){if(h.value)return;let w=I(n.inputRef);if(!w)return;let u=w.value,{selectionStart:O,selectionEnd:r,selectionDirection:v}=w;w.value="",w.value=u,v!==null?w.setSelectionRange(O,r,v):w.setSelectionRange(O,r)}})});let C=$(!1);function M(){C.value=!0}function R(){te().nextFrame(()=>{C.value=!1})}let A=Qe();function F(c){switch(h.value=!0,A(()=>{h.value=!1}),c.key){case V.Enter:if(h.value=!1,n.comboboxState.value!==0||C.value)return;if(c.preventDefault(),c.stopPropagation(),n.activeOptionIndex.value===null){n.closeCombobox();return}n.selectActiveOption(),n.mode.value===0&&n.closeCombobox();break;case V.ArrowDown:return h.value=!1,c.preventDefault(),c.stopPropagation(),N(n.comboboxState.value,{0:()=>n.goToOption(D.Next),1:()=>n.openCombobox()});case V.ArrowUp:return h.value=!1,c.preventDefault(),c.stopPropagation(),N(n.comboboxState.value,{0:()=>n.goToOption(D.Previous),1:()=>{n.openCombobox(),B(()=>{n.value.value||n.goToOption(D.Last)})}});case V.Home:if(c.shiftKey)break;return h.value=!1,c.preventDefault(),c.stopPropagation(),n.goToOption(D.First);case V.PageUp:return h.value=!1,c.preventDefault(),c.stopPropagation(),n.goToOption(D.First);case V.End:if(c.shiftKey)break;return h.value=!1,c.preventDefault(),c.stopPropagation(),n.goToOption(D.Last);case V.PageDown:return h.value=!1,c.preventDefault(),c.stopPropagation(),n.goToOption(D.Last);case V.Escape:if(h.value=!1,n.comboboxState.value!==0)return;c.preventDefault(),n.optionsRef.value&&!n.optionsPropsRef.value.static&&c.stopPropagation(),n.nullable.value&&n.mode.value===0&&n.value.value===null&&p(),n.closeCombobox();break;case V.Tab:if(h.value=!1,n.comboboxState.value!==0)return;n.mode.value===0&&n.activationTrigger.value!==1&&n.selectActiveOption(),n.closeCombobox();break}}function P(c){s("change",c),n.nullable.value&&n.mode.value===0&&c.target.value===""&&p(),n.openCombobox()}function m(c){var S,w,u;let O=(S=c.relatedTarget)!=null?S:ae.find(r=>r!==c.currentTarget);if(h.value=!1,!((w=I(n.optionsRef))!=null&&w.contains(O))&&!((u=I(n.buttonRef))!=null&&u.contains(O))&&n.comboboxState.value===0)return c.preventDefault(),n.mode.value===0&&(n.nullable.value&&n.value.value===null?p():n.activationTrigger.value!==1&&n.selectActiveOption()),n.closeCombobox()}function y(c){var S,w,u;let O=(S=c.relatedTarget)!=null?S:ae.find(r=>r!==c.currentTarget);(w=I(n.buttonRef))!=null&&w.contains(O)||(u=I(n.optionsRef))!=null&&u.contains(O)||n.disabled.value||n.immediate.value&&n.comboboxState.value!==0&&(n.openCombobox(),te().nextFrame(()=>{n.setActivationTrigger(1)}))}let z=x(()=>{var c,S,w,u;return(u=(w=(S=l.defaultValue)!=null?S:n.defaultValue.value!==void 0?(c=l.displayValue)==null?void 0:c.call(l,n.defaultValue.value):null)!=null?w:n.defaultValue.value)!=null?u:""});return()=>{var c,S,w,u,O,r,v;let b={open:n.comboboxState.value===0},{displayValue:g,onChange:E,...T}=l,k={"aria-controls":(c=n.optionsRef.value)==null?void 0:c.id,"aria-expanded":n.comboboxState.value===0,"aria-activedescendant":n.activeOptionIndex.value===null?void 0:n.virtual.value?(S=n.options.value.find(L=>!n.virtual.value.disabled(L.dataRef.value)&&n.compare(L.dataRef.value,n.virtual.value.options[n.activeOptionIndex.value])))==null?void 0:S.id:(w=n.options.value[n.activeOptionIndex.value])==null?void 0:w.id,"aria-labelledby":(r=(u=I(n.labelRef))==null?void 0:u.id)!=null?r:(O=I(n.buttonRef))==null?void 0:O.id,"aria-autocomplete":"list",id:i,onCompositionstart:M,onCompositionend:R,onKeydown:F,onInput:P,onFocus:y,onBlur:m,role:"combobox",type:(v=t.type)!=null?v:"text",tabIndex:0,ref:n.inputRef,defaultValue:z.value,disabled:n.disabled.value===!0?!0:void 0};return H({ourProps:k,theirProps:T,slot:b,attrs:t,slots:o,features:X.RenderStrategy|X.Static,name:"ComboboxInput"})}}}),ft=W({name:"ComboboxOptions",props:{as:{type:[Object,String],default:"ul"},static:{type:Boolean,default:!1},unmount:{type:Boolean,default:!0},hold:{type:[Boolean],default:!1}},setup(l,{attrs:s,slots:t,expose:o}){let e=K("ComboboxOptions"),a=`headlessui-combobox-options-${Z()}`;o({el:e.optionsRef,$el:e.optionsRef}),G(()=>{e.optionsPropsRef.value.static=l.static}),G(()=>{e.optionsPropsRef.value.hold=l.hold});let i=we(),n=x(()=>i!==null?(i.value&Q.Open)===Q.Open:e.comboboxState.value===0);$e({container:x(()=>I(e.optionsRef)),enabled:x(()=>e.comboboxState.value===0),accept(h){return h.getAttribute("role")==="option"?NodeFilter.FILTER_REJECT:h.hasAttribute("role")?NodeFilter.FILTER_SKIP:NodeFilter.FILTER_ACCEPT},walk(h){h.setAttribute("role","none")}});function f(h){h.preventDefault()}return()=>{var h,p,d;let C={open:e.comboboxState.value===0},M={"aria-labelledby":(d=(h=I(e.labelRef))==null?void 0:h.id)!=null?d:(p=I(e.buttonRef))==null?void 0:p.id,id:a,ref:e.optionsRef,role:"listbox","aria-multiselectable":e.mode.value===1?!0:void 0,onMousedown:f},R=ne(l,["hold"]);return H({ourProps:M,theirProps:R,slot:C,attrs:s,slots:e.virtual.value&&e.comboboxState.value===0?{...t,default:()=>[Y(nt,{},t.default)]}:t,features:X.RenderStrategy|X.Static,visible:n.value,name:"ComboboxOptions"})}}}),pt=W({name:"ComboboxOption",props:{as:{type:[Object,String],default:"li"},value:{type:[Object,String,Number,Boolean]},disabled:{type:Boolean,default:!1},order:{type:[Number],default:null}},setup(l,{slots:s,attrs:t,expose:o}){let e=K("ComboboxOption"),a=`headlessui-combobox-option-${Z()}`,i=$(null),n=x(()=>l.disabled);o({el:i,$el:i});let f=x(()=>{var m;return e.virtual.value?e.activeOptionIndex.value===e.calculateIndex(l.value):e.activeOptionIndex.value===null?!1:((m=e.options.value[e.activeOptionIndex.value])==null?void 0:m.id)===a}),h=x(()=>e.isSelected(l.value)),p=de(be,null),d=x(()=>({disabled:l.disabled,value:l.value,domRef:i,order:x(()=>l.order)}));le(()=>e.registerOption(a,d)),re(()=>e.unregisterOption(a,f.value)),G(()=>{let m=I(i);m&&(p==null||p.value.measureElement(m))}),G(()=>{e.comboboxState.value===0&&f.value&&(e.virtual.value||e.activationTrigger.value!==0&&B(()=>{var m,y;return(y=(m=I(i))==null?void 0:m.scrollIntoView)==null?void 0:y.call(m,{block:"nearest"})}))});function C(m){m.preventDefault(),m.button===ve.Left&&(n.value||(e.selectOption(a),De()||requestAnimationFrame(()=>{var y;return(y=I(e.inputRef))==null?void 0:y.focus({preventScroll:!0})}),e.mode.value===0&&e.closeCombobox()))}function M(){var m;if(l.disabled||(m=e.virtual.value)!=null&&m.disabled(l.value))return e.goToOption(D.Nothing);let y=e.calculateIndex(l.value);e.goToOption(D.Specific,y)}let R=Fe();function A(m){R.update(m)}function F(m){var y;if(!R.wasMoved(m)||l.disabled||(y=e.virtual.value)!=null&&y.disabled(l.value)||f.value)return;let z=e.calculateIndex(l.value);e.goToOption(D.Specific,z,0)}function P(m){var y;R.wasMoved(m)&&(l.disabled||(y=e.virtual.value)!=null&&y.disabled(l.value)||f.value&&(e.optionsPropsRef.value.hold||e.goToOption(D.Nothing)))}return()=>{let{disabled:m}=l,y={active:f.value,selected:h.value,disabled:m},z={id:a,ref:i,role:"option",tabIndex:m===!0?void 0:-1,"aria-disabled":m===!0?!0:void 0,"aria-selected":h.value,disabled:void 0,onMousedown:C,onFocus:M,onPointerenter:A,onMouseenter:A,onPointermove:F,onMousemove:F,onPointerleave:P,onMouseleave:P},c=ne(l,["order","value"]);return H({ourProps:z,theirProps:c,slot:y,attrs:t,slots:s,name:"ComboboxOption"})}}});export{Ye as d,fe as e,vt as i,dt as l,ct as n,pt as r,ft as u};
