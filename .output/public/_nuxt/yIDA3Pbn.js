import{_ as At}from"./BrqazIaq.js";import{u as $t}from"./BsD3NFIs.js";import{d as Y,L as Mt,M as Ft,D as j,aa as it,o as k,m as D,x as jt,B as Ut,aR as Bt,ab as A,c as Rt,K as xt,G as lt,v as L,F as pt,A as Vt,y as Tt,b as P,t as Ct,H as W,aS as zt,j as V,h as qt,u as Ht,E as Gt,g as ot,w as ft,i as Nt,az as Yt,I as Jt}from"./C1Qq1QLd.js";import{_ as Zt}from"./DlAUqK2U.js";import{_ as Kt}from"./BfNv8Klg.js";import{_ as Wt}from"./Cl3ZEGEj.js";import{_ as Xt}from"./D5hYVxtM.js";import{_ as Qt}from"./BK4Bl150.js";import{_ as te}from"./BLRN7I0I.js";import{_ as ee}from"./COtxFzAH.js";import{u as ne}from"./X2QR9rfB.js";import{u as re}from"./CDSSNFII.js";class X extends Error{constructor(e){super(e),this.message=e,Object.setPrototypeOf(this,X.prototype)}}const se=Y({props:{schema:{type:[Object,Function],default:void 0},state:{type:Object,required:!0},validate:{type:Function,default:()=>[]},validateOn:{type:Array,default:()=>["blur","input","change","submit"]}},emits:["submit","error"],setup(t,{expose:e,emit:n}){const r=$t("$iLCvx8H2TP"),s=Bt(`form-${r}`);Mt(()=>{s.on(async o=>{var l;o.type!=="submit"&&((l=t.validateOn)!=null&&l.includes(o.type))&&await c(o.path,{silent:!0})})}),Ft(()=>{s.reset()});const a=j([]);it("form-errors",a),it("form-events",s);const d=j({});it("form-inputs",d);async function i(){let o=await t.validate(t.state);if(t.schema)if(le(t.schema))o=o.concat(await ue(t.state,t.schema));else if(ae(t.schema))o=o.concat(await oe(t.state,t.schema));else if(ce(t.schema))o=o.concat(await he(t.state,t.schema));else if(pe(t.schema))o=o.concat(await fe(t.state,t.schema));else throw new Error("Form validation failed: Unsupported form schema");return o}async function c(o,l={silent:!1}){let v=o;if(o&&!Array.isArray(o)&&(v=[o]),v){const h=a.value.filter(m=>!v.includes(m.path)),p=(await i()).filter(m=>v.includes(m.path));a.value=h.concat(p)}else a.value=await i();if(a.value.length>0){if(l.silent)return!1;throw new X(`Form validation failed: ${JSON.stringify(a.value,null,2)}`)}return t.state}async function E(o){var v;const l=o;try{(v=t.validateOn)!=null&&v.includes("submit")&&await c();const h={...l,data:t.state};n("submit",h)}catch(h){if(!(h instanceof X))throw h;const p={...l,errors:a.value.map(m=>({...m,id:d.value[m.path]}))};n("error",p)}}return e({validate:c,errors:a,setErrors(o,l){l?a.value=a.value.filter(v=>v.path!==l).concat(o):a.value=o},async submit(){await E(new Event("submit"))},getErrors(o){return o?a.value.filter(l=>l.path===o):a.value},clear(o){o?a.value=a.value.filter(l=>l.path!==o):a.value=[]}}),{onSubmit:E}}});function ae(t){return t.validate&&t.__isYupSchema__}function ie(t){return t.inner!==void 0}async function oe(t,e){try{return await e.validate(t,{abortEarly:!1}),[]}catch(n){if(ie(n))return n.inner.map(r=>({path:r.path??"",message:r.message}));throw n}}function le(t){return t.parse!==void 0}async function ue(t,e){const n=await e.safeParseAsync(t);return n.success===!1?n.error.issues.map(r=>({path:r.path.join("."),message:r.message})):[]}function ce(t){return t.validateAsync!==void 0&&t.id!==void 0}function de(t){return t.isJoi===!0}async function he(t,e){try{return await e.validateAsync(t,{abortEarly:!1}),[]}catch(n){if(de(n))return n.details.map(r=>({path:r.path.join("."),message:r.message}));throw n}}function pe(t){return"_parse"in t||"_run"in t||typeof t=="function"&&"schema"in t}async function fe(t,e){var r;return((r=(await("_parse"in e?e._parse(t):"_run"in e?e._run({typed:!1,value:t},{}):e(t))).issues)==null?void 0:r.map(s=>{var a;return{path:((a=s.path)==null?void 0:a.map(d=>d.key).join("."))||"",message:s.message}}))||[]}function me(t,e,n,r,s,a){return k(),D("form",{onSubmit:e[0]||(e[0]=Ut((...d)=>t.onSubmit&&t.onSubmit(...d),["prevent"]))},[jt(t.$slots,"default")],32)}const ge=Zt(se,[["render",me]]);function mt(t,e,n,r=s=>s){return t*r(.5-e*(.5-n))}function ve(t){return[-t[0],-t[1]]}function O(t,e){return[t[0]+e[0],t[1]+e[1]]}function I(t,e){return[t[0]-e[0],t[1]-e[1]]}function S(t,e){return[t[0]*e,t[1]*e]}function _e(t,e){return[t[0]/e,t[1]/e]}function H(t){return[t[1],-t[0]]}function gt(t,e){return t[0]*e[0]+t[1]*e[1]}function ye(t,e){return t[0]===e[0]&&t[1]===e[1]}function we(t){return Math.hypot(t[0],t[1])}function be(t){return t[0]*t[0]+t[1]*t[1]}function vt(t,e){return be(I(t,e))}function kt(t){return _e(t,we(t))}function Pe(t,e){return Math.hypot(t[1]-e[1],t[0]-e[0])}function G(t,e,n){let r=Math.sin(n),s=Math.cos(n),a=t[0]-e[0],d=t[1]-e[1],i=a*s-d*r,c=a*r+d*s;return[i+e[0],c+e[1]]}function ut(t,e,n){return O(t,S(I(e,t),n))}function _t(t,e,n){return O(t,S(e,n))}var{min:T,PI:xe}=Math,yt=.275,N=xe+1e-4;function Et(t,e={}){let{size:n=16,smoothing:r=.5,thinning:s=.5,simulatePressure:a=!0,easing:d=u=>u,start:i={},end:c={},last:E=!1}=e,{cap:o=!0,easing:l=u=>u*(2-u)}=i,{cap:v=!0,easing:h=u=>--u*u*u+1}=c;if(t.length===0||n<=0)return[];let p=t[t.length-1].runningLength,m=i.taper===!1?0:i.taper===!0?Math.max(n,p):i.taper,_=c.taper===!1?0:c.taper===!0?Math.max(n,p):c.taper,x=Math.pow(n*r,2),C=[],w=[],U=t.slice(0,10).reduce((u,b)=>{let f=b.pressure;if(a){let g=T(1,b.distance/n),rt=T(1,1-g);f=T(1,u+(rt-u)*(g*yt))}return(u+f)/2},t[0].pressure),y=mt(n,s,t[t.length-1].pressure,d),Q,tt=t[0].vector,z=t[0].point,J=z,B=z,R=J,et=!1;for(let u=0;u<t.length;u++){let{pressure:b}=t[u],{point:f,vector:g,distance:rt,runningLength:q}=t[u];if(u<t.length-1&&p-q<3)continue;if(s){if(a){let F=T(1,rt/n),at=T(1,1-F);b=T(1,U+(at-U)*(F*yt))}y=mt(n,s,b,d)}else y=n/2;Q===void 0&&(Q=y);let St=q<m?l(q/m):1,Ot=p-q<_?h((p-q)/_):1;y=Math.max(.01,y*Math.min(St,Ot));let ct=(u<t.length-1?t[u+1]:t[u]).vector,st=u<t.length-1?gt(g,ct):1,Lt=gt(g,tt)<0&&!et,dt=st!==null&&st<0;if(Lt||dt){let F=S(H(tt),y);for(let at=1/13,K=0;K<=1;K+=at)B=G(I(f,F),f,N*K),C.push(B),R=G(O(f,F),f,N*-K),w.push(R);z=B,J=R,dt&&(et=!0);continue}if(et=!1,u===t.length-1){let F=S(H(g),y);C.push(I(f,F)),w.push(O(f,F));continue}let ht=S(H(ut(ct,g,st)),y);B=I(f,ht),(u<=1||vt(z,B)>x)&&(C.push(B),z=B),R=O(f,ht),(u<=1||vt(J,R)>x)&&(w.push(R),J=R),U=b,tt=g}let $=t[0].point.slice(0,2),M=t.length>1?t[t.length-1].point.slice(0,2):O(t[0].point,[1,1]),nt=[],Z=[];if(t.length===1){if(!(m||_)||E){let u=_t($,kt(H(I($,M))),-(Q||y)),b=[];for(let f=1/13,g=f;g<=1;g+=f)b.push(G(u,$,N*2*g));return b}}else{if(!(m||_&&t.length===1))if(o)for(let b=1/13,f=b;f<=1;f+=b){let g=G(w[0],$,N*f);nt.push(g)}else{let b=I(C[0],w[0]),f=S(b,.5),g=S(b,.51);nt.push(I($,f),I($,g),O($,g),O($,f))}let u=H(ve(t[t.length-1].vector));if(_||m&&t.length===1)Z.push(M);else if(v){let b=_t(M,u,y);for(let f=1/29,g=f;g<1;g+=f)Z.push(G(b,M,N*3*g))}else Z.push(O(M,S(u,y)),O(M,S(u,y*.99)),I(M,S(u,y*.99)),I(M,S(u,y)))}return C.concat(Z,w.reverse(),nt)}function It(t,e={}){var n;let{streamline:r=.5,size:s=16,last:a=!1}=e;if(t.length===0)return[];let d=.15+(1-r)*.85,i=Array.isArray(t[0])?t:t.map(({x:h,y:p,pressure:m=.5})=>[h,p,m]);if(i.length===2){let h=i[1];i=i.slice(0,-1);for(let p=1;p<5;p++)i.push(ut(i[0],h,p/4))}i.length===1&&(i=[...i,[...O(i[0],[1,1]),...i[0].slice(2)]]);let c=[{point:[i[0][0],i[0][1]],pressure:i[0][2]>=0?i[0][2]:.25,vector:[1,1],distance:0,runningLength:0}],E=!1,o=0,l=c[0],v=i.length-1;for(let h=1;h<i.length;h++){let p=a&&h===v?i[h].slice(0,2):ut(l.point,i[h],d);if(ye(l.point,p))continue;let m=Pe(p,l.point);if(o+=m,h<v&&!E){if(o<s)continue;E=!0}l={point:p,pressure:i[h][2]>=0?i[h][2]:.5,vector:kt(I(l.point,p)),distance:m,runningLength:o},c.push(l)}return c[0].vector=((n=c[1])==null?void 0:n.vector)||[0,0],c}function Dt(t,e={}){return Et(It(t,e),e)}var Ce=Dt;const ke=Object.freeze(Object.defineProperty({__proto__:null,default:Ce,getStroke:Dt,getStrokeOutlinePoints:Et,getStrokePoints:It},Symbol.toStringTag,{value:"Module"}));function Ee(t){return t?Object.entries(t).reduce((e,[n,r])=>(n=n.charAt(0).toUpperCase()+n.slice(1),n=`on${n}`,{...e,[n]:r}),{}):null}function Ie(t,e={},n){const{props:r,domProps:s,on:a,...d}=e,i=Ee(a),c={...d,...r,...s,...i};return A(t,c,n)}var De=Ie;function wt(t){if(!t.length)return"";const e=t.reduce((n,[r,s],a,d)=>{const[i,c]=d[(a+1)%d.length];return n.push(r,s,(r+i)/2,(s+c)/2),n},["M",...t[0],"Q"]);return e.push("Z"),e.join(" ")}var Se="rgba(0,0,0,0)",Oe="#000",Le="100%",Ae="100%",bt=["image/png","image/jpeg","image/svg+xml"],{getStroke:Pt}=ke,$e=Y({props:{width:{type:String,required:!1,default:Le},height:{type:String,required:!1,default:Ae},backgroundColor:{type:String,required:!1,default:Se},penColor:{type:String,required:!1,default:Oe},strokeOptions:{type:Object,required:!1,default:()=>({})}},emits:["onBegin","onEnd"],data:()=>({allInputPoints:[],currentInputPoints:null,isDrawing:!1,isLocked:!1,cachedImages:[],ctx:null}),watch:{backgroundColor(){this.setBackgroundAndPenColor()},penColor(t){const e=this.getCanvasContext();e&&(e.fillStyle=t)},allInputPoints:{deep:!0,handler(){this.inputPointsHandler()}},currentInputPoints:{deep:!0,handler(){this.inputPointsHandler()}}},mounted(){this.resizeCanvas()},methods:{_drawImage(t){const e=this.getCanvasElement(),n=this.getCanvasContext(),r=window.devicePixelRatio||1;n==null||n.scale(1/r,1/r),n==null||n.drawImage(t,0,0,e.width,e.height),n==null||n.scale(r,r)},handlePointerDown(t){if(this.isLocked)return;t.preventDefault();const n=t.composedPath()[0].getBoundingClientRect(),r=t.clientX-n.left,s=t.clientY-n.top;this.currentInputPoints=[[r,s,t.pressure]],this.isDrawing=!0,this.$emit("onBegin",t)},handlePointerMove(t){if(!this.isLocked&&this.isDrawing&&t.buttons===1){t.preventDefault();const n=t.composedPath()[0].getBoundingClientRect(),r=t.clientX-n.left,s=t.clientY-n.top;this.currentInputPoints=[...this.currentInputPoints??[],[r,s,t.pressure]]}},handlePointerUp(t){this.isLocked||(t.preventDefault(),this.isDrawing=!1,this.currentInputPoints&&(this.allInputPoints=[...this.allInputPoints,this.currentInputPoints],this.currentInputPoints=null,this.$emit("onEnd",t)))},handlePointerEnter(t){this.isLocked||t.buttons===1&&this.handlePointerDown(t)},handlePointerLeave(t){this.isLocked||this.isDrawing&&this.handlePointerUp(t)},isEmpty(){return!this.allInputPoints.length&&!this.cachedImages.length},clear(){this.cachedImages=[],this.allInputPoints=[],this.currentInputPoints=null},fromData(t){this.allInputPoints=[...this.allInputPoints,...t]},lock(){this.isLocked=!0},unlock(){this.isLocked=!1},toData(){return this.allInputPoints},fromDataURL(t){return new Promise((e,n)=>{const r=new Image;r.onload=()=>{this._drawImage(r),this.cachedImages.push(r),e(!0)},r.onerror=()=>{n(new Error("Incorrect data uri provided"))},r.crossOrigin="anonymous",r.src=t})},toDataURL(t){if(t&&!bt.includes(t))throw new Error(`Incorrect image type. Must be one of ${bt.join(", ")}.`);return this.isEmpty()?void 0:this.getCanvasElement().toDataURL(t??"image/png")},getCanvasElement(){return this.$refs.signaturePad},getCanvasContext(){if(!this.ctx){const t=this.getCanvasElement();this.ctx=t.getContext("2d")}return this.ctx},setBackgroundAndPenColor(){const t=this.getCanvasElement(),e=t.getContext("2d");e.fillStyle=this.backgroundColor,e==null||e.fillRect(0,0,t.width,t.height),e.fillStyle=this.penColor},resizeCanvas(t=!0){const e=this.getCanvasElement(),n=e.getBoundingClientRect(),r=window.devicePixelRatio||1;e.width=n.width*r,e.height=n.height*r;const s=this.getCanvasContext();s==null||s.scale(r,r),e.style.width=`${n.width}px`,e.style.height=`${n.height}px`,t&&(s==null||s.clearRect(0,0,e.width,e.height),this.clear()),this.setBackgroundAndPenColor()},inputPointsHandler(){const t=this.getCanvasElement(),e=this.getCanvasContext();if(e==null||e.clearRect(0,0,t.width,t.height),this.cachedImages.forEach(s=>this._drawImage(s)),this.setBackgroundAndPenColor(),this.allInputPoints.forEach(s=>{const a=wt(Pt(s,this.strokeOptions)),d=new Path2D(a);e==null||e.fill(d)}),!this.currentInputPoints)return;const n=wt(Pt(this.currentInputPoints,this.strokeOptions)),r=new Path2D(n);e==null||e.fill(r)}},render(){const{width:t,height:e}=this,n={pointerdown:this.handlePointerDown,pointerup:this.handlePointerUp,pointermove:this.handlePointerMove,pointerenter:this.handlePointerEnter,pointerleave:this.handlePointerLeave};return De("canvas",{ref:"signaturePad",style:{height:e,width:t,touchAction:"none"},on:n})}});const Me={class:"relative w-full p-4 overflow-hidden bg-white border dark:bg-gray-800 dark:border-gray-700"},Fe={class:"flex justify-between border-b dark:border-gray-700"},je={class:"flex gap-x-4"},Ue=["onClick"],Be={class:"relative w-full"},Re=L("div",{class:"absolute w-full h-px bg-gray-300 dark:bg-gray-700 bottom-8"},null,-1),Ve={key:0,class:"absolute inset-0 flex items-center justify-center w-full pointer-events-none"},Te=L("p",{class:"text-5xl text-gray-300 dark:text-gray-600 font-signature"},"Draw Signature Here",-1),ze=[Te],qe={class:"z-10"},He={key:2,class:"p-4"},Ge=L("p",{id:"file_input_help",class:"mt-1 text-sm text-gray-500 dark:text-gray-300"}," Accepted: SVG, PNG, JPG or GIF ",-1),Ne=Y({__name:"VSignature",props:{context:Object},setup(t){var p,m;const e=ne(),n=t,r=((p=n.context)==null?void 0:p.options)??["type","draw","upload"],s=j(((m=n.context)==null?void 0:m.value)??{type:"draw",text:void 0,image:void 0}),a=j(null),d={size:8,thinning:.75,smoothing:.5,streamline:.5},i=j(!1),c=Rt(()=>e.value==="dark"?"#ffffff":"#0f172a");function E(){i.value=!0}function o(){var x;i.value=!1;const _=h((x=a.value)==null?void 0:x.toDataURL(),"signature.png");s.value.image=_}function l(_){const x=_.target.files;if(x&&x.length>0){const C=x[0];s.value.image=C}}function v(){var _;s.value.type==="draw"?(_=a.value)==null||_.clear():(s.value.text=void 0,s.value.image=void 0)}function h(_,x){const C=_.split(",")[0].split(":")[1].split(";")[0],w=atob(_.split(",")[1]),U=new Uint8Array(w.length);for(let y=0;y<w.length;y++)U[y]=w.charCodeAt(y);return new File([new Blob([U],{type:C})],x,{type:C})}return xt(s.value,(_,x)=>{var C;(C=n.context)==null||C.node.input(x)},{deep:!0}),(_,x)=>{const C=lt("auto-animate");return k(),D("div",Me,[L("div",Fe,[L("div",je,[(k(!0),D(pt,null,Vt(P(r),w=>(k(),D("button",{key:w,type:"button",class:Tt([P(s).type===w?" border-primary":"border-transparent","border-b-4 pb-2  px-2 capitalize dark:text-white transition duration-150 ease-in-out"]),onClick:U=>P(s).type=w},Ct(w),11,Ue))),128))]),L("div",null,[L("button",{type:"button",class:"px-2 pb-2 dark:text-white",onClick:v},"Clear")])]),W((k(),D("div",Be,[P(s).type==="type"?W((k(),D("input",{key:0,"onUpdate:modelValue":x[0]||(x[0]=w=>P(s).text=w),type:"text",class:"w-full px-4 py-3 text-3xl text-gray-900 border-0 border-b border-gray-300 dark:bg-gray-800 dark:text-white focus:ring-0 focus:border-primary placeholder:text-gray-400 dark:placeholder:text-gray-600 font-signature",placeholder:"Type your signature"},null,512)),[[zt,P(s).text]]):V("",!0),P(s).type==="draw"?(k(),D(pt,{key:1},[Re,!P(i)&&P(s).image===void 0?(k(),D("div",Ve,ze)):V("",!0),L("div",qe,[qt(P($e),{ref_key:"signaturePad",ref:a,"stroke-options":d,height:"200px","pen-color":P(c),onOnBegin:E,onOnEnd:o},null,8,["pen-color"])])],64)):V("",!0),P(s).type==="upload"?(k(),D("div",He,[L("input",{class:"block w-full text-sm text-gray-900 cursor-pointer dark:text-gray-400 focus:ring-1 focus:ring-primary focus:outline-none",type:"file",accept:"image/*",onChange:l},null,32),Ge])):V("",!0)])),[[C]])])}}}),Ye={33:"md:col-span-2",50:"md:col-span-3",67:"md:col-span-4",100:"md:col-span-6"};function Je(t,e,n){const r={modelValue:n[e],"onUpdate:modelValue":s=>n[e]=s};switch(t.type){case"textarea":return A(Xt,{...r,placeholder:t.placeholder});case"file":return A(ee,{...r,placeholder:t.placeholder});case"signature":return A(Ne,{...r,placeholder:t.placeholder});case"checkbox":return A(Qt,r);default:return A(Wt,{...r,placeholder:t.placeholder,type:t.type})}}const Ze=Y({props:{schema:{type:Array,default:()=>[]},state:{type:Object,default:()=>({})},validate:{type:Function},onSubmit:{type:Function}},setup(t){var n;const e=(n=t==null?void 0:t.schema)==null?void 0:n.map(r=>{const{name:s,label:a,placeholder:d,width:i,description:c}=r,E=Ye[r.width]||"md:col-span-6";return A(Kt,{name:s,label:a,description:c,class:E,size:"lg"},()=>[Je(r,s,t.state)])});if(e)return e.push(A("div",{class:"md:col-span-6"},A(te,{type:"submit",size:"lg",label:"Submit",onClick:r=>{r.preventDefault(),t.onSubmit()}}))),()=>A(ge,{state:t.state,validate:t.validate},()=>e)}}),Ke={class:"mb-4"},We={key:0},Xe={key:1},hn=Y({__name:"UForm",props:{form:{}},emits:["submit","update:modelValue"],setup(t,{emit:e}){const n=t,r=e,{query:s}=Ht(),a=Gt({...s}),d=j(!1),i=j(null),c=j(!1),E=l=>{const v=[];return l.email||v.push({path:"email",message:"Required"}),v};async function o(){d.value=!0;try{if(await re(Yt("inbox",{data:a,form:n.form.id})),c.value=!0,n.form.on_success==="redirect")return Jt(n.form.redirect_url)}catch(l){i.value=l}finally{d.value=!1}}return xt(a,()=>{r("update:modelValue",a)},{deep:!0}),(l,v)=>{const h=At,p=Ze,m=lt("dompurify-html"),_=lt("auto-animate");return W((k(),D("div",null,[L("div",Ke,[P(i)?(k(),ot(h,{key:0,type:"error"},{default:ft(()=>[Nt("Oops! "+Ct(P(i)),1)]),_:1})):V("",!0),l.form.on_success==="message"&&P(c)?(k(),ot(h,{key:1,type:"success"},{default:ft(()=>[l.form.success_message?W((k(),D("div",We,null,512)),[[m,l.form.success_message]]):(k(),D("p",Xe,"Success! Your form has been submitted."))]),_:1})):V("",!0)]),L("div",null,[P(c)?V("",!0):(k(),ot(p,{key:0,schema:n.form.schema,state:P(a),validate:E,class:"grid gap-6 md:grid-cols-6","on-submit":o},null,8,["schema","state"]))])])),[[_]])}}});export{hn as _};
