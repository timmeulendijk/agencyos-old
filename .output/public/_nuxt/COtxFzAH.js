import{_ as U}from"./CYRz50eo.js";import A from"./Dts3F0k1.js";import{_ as N}from"./DlAUqK2U.js";import{o as n,m as i,v as c,d as j,D as b,aA as P,e as H,g as $,j as g,b as r,y as O,B as k,h as _,t as w,w as B,T as Y,i as q,F as G,A as J}from"./C1Qq1QLd.js";import{_ as K}from"./BrqazIaq.js";import{_ as Q}from"./nG6B8Cf1.js";import{u as R}from"./CDSSNFII.js";const W={},X={class:"animate-spin",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},Z=c("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"},null,-1),ee=c("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"},null,-1),te=[Z,ee];function re(D,z){return n(),i("svg",X,te)}const oe=N(W,[["render",re]]),ae=["multiple","accept"],se={class:"h-full mx-auto text-sm font-medium text-center"},ne={key:0},le={key:1},ie={key:2,class:"mt-1 text-xs"},ce={key:0,class:"absolute inset-0 flex items-center justify-center bg-white rounded-md bg-opacity-70 dark:bg-gray-800 dark:bg-opacity-90"},de={class:"mt-2 space-y-2"},ue={class:"relative flex items-center px-4 py-2 rounded-md bg-gray-50 dark:bg-gray-800"},pe={class:"sm:text-sm dark:text-gray-200"},me={class:"flex ml-auto cursor-pointer"},fe=["onClick"],xe=j({__name:"VUpload",props:{label:{},modelValue:{default:()=>[]},multiple:{type:Boolean,default:!1},sizeLimitMb:{default:5},accept:{default:"image/*"},folderId:{default:null}},emits:["update:modelValue","error","success"],setup(D,{emit:z}){const p=D,y=z,{dragging:x,onDragEnter:V,onDragLeave:L,onDrop:M}=T(),{uploading:h,error:C,onSelect:F,processUpload:E}=I(),l=b(p.modelValue);function S(o){l.value=l.value.filter((t,d)=>d!==o),y("update:modelValue",l.value)}function T(){const o=b(!1);let t=0;return{onDragEnter:d,onDragLeave:u,onDrop:m,dragging:o};function d(){t++,t===1&&(o.value=!0)}function u(){t--,t===0&&(o.value=!1)}function m(f){if(t=0,o.value=!1,!f.dataTransfer)return;const s=f.dataTransfer.files;s.length>0&&E(s)}}function I(){const o=b(!1),t=b(null);return{uploading:o,error:t,processUpload:d,uploadFile:u,checkFileSize:m,onSelect:f};async function d(s){t.value=null,o.value=!0;const e=Array.from(s);try{if(e.length>1){const a=await Promise.all(e.map(v=>u(v)));l.value.push(...a),y("update:modelValue",l.value)}else{const a=e[0];m(a);const v=await u(a);l.value.push(v),y("update:modelValue",l.value)}y("success",l.value)}catch(a){t.value=a.message}finally{o.value=!1}}async function u(s){try{const e=new FormData;return p.folderId&&e.append("folder",p.folderId),e.append("file",s),await R(P(e))}catch{throw H({statusCode:500,statusMessage:"Error uploading file..."})}}function m(s){if(p.sizeLimitMb){const e=s.size/1e6;if(e>p.sizeLimitMb)throw new Error(`Oops. Your file size is ${e.toFixed(2)}MB, the max is ${p.sizeLimitMb}MB`)}}function f(s){const a=s.target.files;a&&a.length>0&&d(a)}}return(o,t)=>{const d=U,u=A,m=oe,f=K,s=Q;return n(),i("fieldset",null,[o.label?(n(),$(d,{key:0,label:o.label},null,8,["label"])):g("",!0),o.multiple||r(l).length===0?(n(),i("div",{key:1,class:O(["dropzone",{"border-primary bg-primary-50 dark:bg-primary !text-primary  dark:!text-gray-100 dark:border-primary":r(x),"hover:border-primary hover:text-primary dark:hover:text-primary dark:hover:border-primary":!r(x)&&!r(h),"text-gray-500 border-gray-300 dark:text-gray-100 dark:border-gray-700":!r(h),"cursor-not-allowed dark:border-gray-700 dark:text-gray-100 text-gray-500 border-gray-300":r(h)}]),onDragenter:t[1]||(t[1]=k((...e)=>r(V)&&r(V)(...e),["prevent"])),onDragover:t[2]||(t[2]=k(()=>{},["prevent"])),onDragleave:t[3]||(t[3]=k((...e)=>r(L)&&r(L)(...e),["prevent"])),onDrop:t[4]||(t[4]=k((...e)=>r(M)&&r(M)(...e),["stop","prevent"]))},[c("input",{type:"file",class:"absolute inset-0 opacity-0 appearance-none cursor-pointer",multiple:o.multiple,accept:o.accept,onChange:t[0]||(t[0]=(...e)=>r(F)&&r(F)(...e))},null,40,ae),c("div",se,[_(u,{name:"heroicons:cloud-arrow-up",class:"w-8 h-8 mx-auto mb-2"}),r(x)?(n(),i("p",ne,"Drop to upload")):(n(),i("p",le,"Drag and drop files here or click to browse")),o.sizeLimitMb?(n(),i("p",ie,"Max File Size: "+w(o.sizeLimitMb)+" MB",1)):g("",!0)]),_(Y,{"enter-active-class":"transition duration-150 ease-out","enter-from-class":"transform scale-95 opacity-0","enter-to-class":"transform scale-100 opacity-100","leave-active-class":"transition duration-100 ease-in","leave-from-class":"transform scale-100 opacity-100","leave-to-class":"transform scale-95 opacity-0"},{default:B(()=>[r(h)?(n(),i("div",ce,[_(m,{class:"w-16 h-16 text-primary dark:text-primary"})])):g("",!0)]),_:1})],34)):g("",!0),r(C)?(n(),$(f,{key:2,type:"error",class:"mt-2"},{default:B(()=>[q(w(r(C)),1)]),_:1})):g("",!0),c("ul",de,[(n(!0),i(G,null,J(r(l),(e,a)=>(n(),i("li",{key:e.id},[c("div",ue,[_(s,{src:e.id,class:"object-contain w-12 h-12 mr-4 dark:brightness-90"},null,8,["src"]),c("span",pe,w(e.filename_download),1),c("span",me,[c("button",{onClick:v=>S(a)},[_(u,{name:"heroicons:trash",class:"w-5 h-5 text-red-500 stroke-current hover:text-red-600 flex-shrink-none"})],8,fe)])])]))),128))])])}}});export{xe as _};
