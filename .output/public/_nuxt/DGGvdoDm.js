import{_ as ge}from"./BLRN7I0I.js";import{_ as ve}from"./CfNxAj-D.js";import{_ as fe}from"./Cl3ZEGEj.js";import{_ as pe}from"./BWVliGJj.js";import{n as be,p as j,d as ie,q as X,c as m,r as _e,s as B,o as b,m as h,v as C,F as K,A as x,t as I,z as ye,y as O,x as ee,h as c,j as Z,u as he,Y as Ce,D as W,Z as Ie,K as Ae,G as Se,w as s,b as a,i as p,S as Y,H as ze,g as te,k as $e,l as ae}from"./C1Qq1QLd.js";import{U as ke}from"./DWctDv8V.js";import{s as Ve,u as we,g as ne}from"./dCmjBx8L.js";import{u as Ue}from"./D3QtpRVU.js";import{u as Be}from"./KCR-tHi3.js";import{_ as Oe}from"./DlAUqK2U.js";import{_ as je}from"./BkkHuSuh.js";import{_ as Ne}from"./DX9skQdG.js";import{_ as De}from"./BwYgItWI.js";import{_ as Pe}from"./D_yz1VK7.js";import{_ as Te}from"./CswkOXNq.js";import{_ as Fe}from"./Sc7ob8XJ.js";import{_ as Re}from"./Cb2pLvH4.js";import{w as qe,u as le}from"./CDSSNFII.js";import{u as Le}from"./CE-_QWdS.js";import{f as oe}from"./sQXfV4VV.js";import{g as We,a as Ge}from"./CGNRextM.js";import"./DnmWVJMN.js";import"./Dts3F0k1.js";import"./D9e1F_hZ.js";import"./BAzV2P3u.js";import"./BmwJRmHE.js";import"./BK4Bl150.js";import"./BsD3NFIs.js";import"./DKF2w7xO.js";import"./Bf5SMuIn.js";const y=be(j.ui.strategy,j.ui.select,Ve),Me=ie({components:{UIcon:ke},inheritAttrs:!1,props:{modelValue:{type:[String,Number,Object],default:""},id:{type:String,default:null},name:{type:String,default:null},placeholder:{type:String,default:null},required:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1},icon:{type:String,default:null},loadingIcon:{type:String,default:()=>y.default.loadingIcon},leadingIcon:{type:String,default:null},trailingIcon:{type:String,default:()=>y.default.trailingIcon},trailing:{type:Boolean,default:!1},leading:{type:Boolean,default:!1},loading:{type:Boolean,default:!1},padded:{type:Boolean,default:!0},options:{type:Array,default:()=>[]},size:{type:String,default:null,validator(e){return Object.keys(y.size).includes(e)}},color:{type:String,default:()=>y.default.color,validator(e){return[...j.ui.colors,...Object.keys(y.color)].includes(e)}},variant:{type:String,default:()=>y.default.variant,validator(e){return[...Object.keys(y.variant),...Object.values(y.color).flatMap(g=>Object.keys(g))].includes(e)}},optionAttribute:{type:String,default:"label"},valueAttribute:{type:String,default:"value"},selectClass:{type:String,default:null},class:{type:[String,Object,Array],default:()=>""},ui:{type:Object,default:()=>({})}},emits:["update:modelValue","change"],setup(e,{emit:g,slots:$}){const{ui:t,attrs:S}=we("select",X(e,"ui"),y,X(e,"class")),{size:N,rounded:v}=Be({ui:t,props:e}),{emitFormChange:r,inputId:d,color:i,size:A,name:D}=Ue(e,y),_=m(()=>N.value??A.value),Q=l=>{g("update:modelValue",l.target.value)},G=l=>{g("change",l.target.value),r()},P=l=>ne(l,e.valueAttribute,""),w=l=>ne(l,e.optionAttribute,""),T=l=>["string","number","boolean"].includes(typeof l)?{[e.valueAttribute]:l,[e.optionAttribute]:l}:{...l,[e.valueAttribute]:P(l),[e.optionAttribute]:w(l)},F=m(()=>e.options.map(l=>T(l))),R=m(()=>e.placeholder?[{[e.valueAttribute]:"",[e.optionAttribute]:e.placeholder,disabled:!0},...F.value]:F.value),M=m(()=>{const l=T(e.modelValue),z=R.value.find(V=>V[e.valueAttribute]===l[e.valueAttribute]);return z?z[e.valueAttribute]:""}),H=m(()=>{var z,V;const l=((V=(z=t.value.color)==null?void 0:z[i.value])==null?void 0:V[e.variant])||t.value.variant[e.variant];return _e(B(t.value.base,t.value.form,v.value,t.value.size[_.value],e.padded?t.value.padding[_.value]:"p-0",l==null?void 0:l.replaceAll("{color}",i.value),(k.value||$.leading)&&t.value.leading.padding[_.value],(U.value||$.trailing)&&t.value.trailing.padding[_.value]),e.placeholder&&!e.modelValue&&t.value.placeholder,e.selectClass)}),k=m(()=>e.icon&&e.leading||e.icon&&!e.trailing||e.loading&&!e.trailing||e.leadingIcon),U=m(()=>e.icon&&e.trailing||e.loading&&e.trailing||e.trailingIcon),q=m(()=>e.loading?e.loadingIcon:e.leadingIcon||e.icon),L=m(()=>e.loading&&!k.value?e.loadingIcon:e.trailingIcon||e.icon),n=m(()=>B(t.value.icon.leading.wrapper,t.value.icon.leading.pointer,t.value.icon.leading.padding[_.value])),u=m(()=>B(t.value.icon.base,i.value&&j.ui.colors.includes(i.value)&&t.value.icon.color.replaceAll("{color}",i.value),t.value.icon.size[_.value],e.loading&&t.value.icon.loading)),f=m(()=>B(t.value.icon.trailing.wrapper,t.value.icon.trailing.pointer,t.value.icon.trailing.padding[_.value])),E=m(()=>B(t.value.icon.base,i.value&&j.ui.colors.includes(i.value)&&t.value.icon.color.replaceAll("{color}",i.value),t.value.icon.size[_.value],e.loading&&!k.value&&t.value.icon.loading));return{ui:t,attrs:S,name:D,inputId:d,normalizedOptionsWithPlaceholder:R,normalizedValue:M,isLeading:k,isTrailing:U,selectClass:H,leadingIconName:q,leadingIconClass:u,leadingWrapperIconClass:n,trailingIconName:L,trailingIconClass:E,trailingWrapperIconClass:f,onInput:Q,onChange:G}}}),He=["id","name","value","required","disabled"],Ee=["value","label"],Je=["value","selected","disabled","textContent"],Ke=["value","selected","disabled","textContent"];function Ye(e,g,$,t,S,N){const v=pe;return b(),h("div",{class:O(e.ui.wrapper)},[C("select",ye({id:e.inputId,name:e.name,value:e.modelValue,required:e.required,disabled:e.disabled,class:e.selectClass},e.attrs,{onInput:g[0]||(g[0]=(...r)=>e.onInput&&e.onInput(...r)),onChange:g[1]||(g[1]=(...r)=>e.onChange&&e.onChange(...r))}),[(b(!0),h(K,null,x(e.normalizedOptionsWithPlaceholder,(r,d)=>(b(),h(K,null,[r.children?(b(),h("optgroup",{key:`${r[e.valueAttribute]}-optgroup-${d}`,value:r[e.valueAttribute],label:r[e.optionAttribute]},[(b(!0),h(K,null,x(r.children,(i,A)=>(b(),h("option",{key:`${i[e.valueAttribute]}-${d}-${A}`,value:i[e.valueAttribute],selected:i[e.valueAttribute]===e.normalizedValue,disabled:i.disabled,textContent:I(i[e.optionAttribute])},null,8,Je))),128))],8,Ee)):(b(),h("option",{key:`${r[e.valueAttribute]}-${d}`,value:r[e.valueAttribute],selected:r[e.valueAttribute]===e.normalizedValue,disabled:r.disabled,textContent:I(r[e.optionAttribute])},null,8,Ke))],64))),256))],16,He),e.isLeading&&e.leadingIconName||e.$slots.leading?(b(),h("span",{key:0,class:O(e.leadingWrapperIconClass)},[ee(e.$slots,"leading",{disabled:e.disabled,loading:e.loading},()=>[c(v,{name:e.leadingIconName,class:O(e.leadingIconClass)},null,8,["name","class"])],!0)],2)):Z("",!0),e.isTrailing&&e.trailingIconName||e.$slots.trailing?(b(),h("span",{key:1,class:O(e.trailingWrapperIconClass)},[ee(e.$slots,"trailing",{disabled:e.disabled,loading:e.loading},()=>[c(v,{name:e.trailingIconName,class:O(e.trailingIconClass),"aria-hidden":"true"},null,8,["name","class"])],!0)],2)):Z("",!0)],2)}const Ze=Oe(Me,[["render",Ye],["__scopeId","data-v-53971a23"]]),Qe=""+new URL("tokyo-attention-sign.CwvjNYnN.svg",import.meta.url).href,Xe={class:"flex items-center justify-between gap-3"},xe={class:"flex gap-3"},et={class:"w-1/4 mx-auto text-center"},tt=C("img",{src:Qe,alt:"Empty State"},null,-1),at={class:"flex flex-wrap items-center justify-between"},nt={class:"text-sm leading-5"},lt={class:"font-medium"},ot={class:"font-medium"},it={class:"font-medium"},Tt=ie({__name:"index",async setup(e){var q,L;let g,$;const{path:t,query:S}=he(),N=Ce(),v=W(((q=S==null?void 0:S.search)==null?void 0:q.toString())??void 0),r=Ie(v,500),d=W(((L=S.status)==null?void 0:L.toString())??void 0),i=W(1),A=W(25),{data:D,pending:_,error:Q,refresh:G}=([g,$]=qe(()=>$e(t,()=>{const n=Object.assign({},a(v)&&{search:a(v)},a(d)&&{filter:{status:{_eq:a(d)}}},{limit:a(A),page:a(i)}),u=le(ae("os_invoices",{fields:["*",{contact:["id","first_name","last_name","email"]}],...n})),f=le(ae("os_invoices",{aggregate:{count:["*"]},filter:{...a(d)&&{status:{_eq:a(d)}}}}));return Promise.all([u,f])},{transform:([n,u])=>({invoices:n,count:parseInt(u[0].count)})})),g=await g,$(),g),P=m(()=>{var n;return((n=D.value)==null?void 0:n.invoices)??[]}),w=m(()=>{var n;return((n=D.value)==null?void 0:n.count)??0}),T=m(()=>(i.value-1)*A.value+(P.value.length?1:0)),F=m(()=>Math.min(i.value*A.value,w.value)),R=[{label:"Open",value:"unpaid"},{label:"Paid",value:"paid"},{label:"All",value:""}],M=[{key:"invoice_number",label:"#",sortable:!0},{key:"status",label:"Status"},{key:"due_date",label:"Due Date",sortable:!0},{key:"contact",label:"Contact"},{key:"total",label:"Total",sortable:!0},{key:"amount_due",label:"Amount Due",sortable:!0},{key:"actions"}],{getPortalLink:H,loading:k}=Le();Ae([r,d,i],([n,u,f])=>{N.push({path:t,query:{search:n==null?void 0:n.toString(),status:u==null?void 0:u.toString(),page:f==null?void 0:f.toString()}}),G()});function U(){v.value=void 0,d.value=void 0}return(n,u)=>{const f=ge,E=ve,l=fe,z=Ze,V=je,se=Ne,re=De,J=Pe,ue=Te,de=Fe,ce=Re,me=Se("auto-animate");return b(),h("div",null,[c(E,{title:"Invoices",breadcrumbs:[{title:"Portal",href:"/portal"},{title:"Billing"}]},{actions:s(()=>[c(f,{color:"primary",variant:"outline",size:"xl",loading:a(k),onClick:u[0]||(u[0]=o=>a(H)("cus_OlTbJKVanSb1zN"))},{default:s(()=>[p(" Update Payment Settings ")]),_:1},8,["loading"])]),_:1}),c(ce,{class:"mt-6"},{header:s(()=>[C("div",Xe,[c(l,{modelValue:a(v),"onUpdate:modelValue":u[1]||(u[1]=o=>Y(v)?v.value=o:null),icon:"i-heroicons-magnifying-glass-20-solid",placeholder:"Search...",type:"text"},null,8,["modelValue"]),C("div",xe,[c(z,{modelValue:a(d),"onUpdate:modelValue":u[2]||(u[2]=o=>Y(d)?d.value=o:null),options:R,placeholder:"Invoice Status"},null,8,["modelValue"]),c(f,{color:"white",size:"xs",disabled:!a(v)&&!a(d),icon:"material-symbols:filter-alt-off-outline-rounded",onClick:U},{default:s(()=>[p(" Reset ")]),_:1},8,["disabled"])])])]),footer:s(()=>[C("div",at,[c(J,null,{default:s(()=>[C("span",nt,[p(" Showing "),C("span",lt,I(a(T)),1),p(" to "),C("span",ot,I(a(F)),1),p(" of "),C("span",it,I(a(w)),1),p(" results ")])]),_:1}),c(de,{modelValue:a(i),"onUpdate:modelValue":u[3]||(u[3]=o=>Y(i)?i.value=o:null),"page-count":a(A),total:a(w)},null,8,["modelValue","page-count","total"])])]),default:s(()=>[ze((b(),te(ue,{columns:M,rows:a(P),"column-attribute":"label",loading:a(_)},{"empty-state":s(()=>[C("div",et,[tt,c(V,{content:"Looks like there's nothing here.",size:"xs"}),a(v)||a(d)?(b(),te(f,{key:0,color:"white",size:"xs",icon:"material-symbols:filter-alt-off-outline-rounded",class:"mt-4",onClick:U},{default:s(()=>[p(" Reset Filters ")]),_:1})):Z("",!0)])]),"invoice_number-data":s(({row:o})=>[c(f,{variant:"outline",to:`/portal/billing/invoices/${o.id}`,padding:!1},{default:s(()=>[p(I(o.invoice_number),1)]),_:2},1032,["to"])]),"amount_due-data":s(({row:o})=>[p(I(("formatCurrency"in n?n.formatCurrency:a(oe))(o.amount_due)),1)]),"total-data":s(({row:o})=>[p(I(("formatCurrency"in n?n.formatCurrency:a(oe))(o.total)),1)]),"contact-data":s(({row:o})=>[c(se,{user:o.contact,size:"sm"},null,8,["user"])]),"status-data":s(({row:o})=>[c(re,{label:o.status,color:o.status==="unpaid"?"rose":"primary",size:"xs",class:"capitalize"},null,8,["label","color"])]),"due_date-data":s(({row:o})=>[c(J,{size:"xs"},{default:s(()=>[p(I(("getFriendlyDate"in n?n.getFriendlyDate:a(We))(o.due_date,{monthAbbr:!0})),1)]),_:2},1024),c(J,{size:"xs","text-color":"light"},{default:s(()=>[p(I(("getRelativeTime"in n?n.getRelativeTime:a(Ge))(o.due_date)),1)]),_:2},1024)]),"actions-data":s(({row:o})=>[c(f,{to:`/portal/billing/invoices/${o.id}`,color:"primary",variant:"outline",icon:"i-heroicons-arrow-right"},null,8,["to"])]),_:1},8,["rows","loading"])),[[me]])]),_:1})])}}});export{Tt as default};
